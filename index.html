<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Budggt Lite</title>

<style>
:root{
  --bg:#0b1220;
  --card:#111827;
  --primary:#4f46e5;
  --green:#22c55e;
  --red:#ef4444;
}

body{
  background:linear-gradient(180deg,#0b1220,#070b14);
  color:white;
  font-family:-apple-system,system-ui;
  margin:0;
}

.app{
  max-width:420px;
  margin:auto;
  padding:12px;
}

#saldo{
  background:var(--card);
  padding:16px;
  border-radius:16px;
  font-size:24px;
  font-weight:bold;
  margin:10px 0;
  text-align:center;
}

input,select,button{
  width:100%;
  padding:14px;
  margin:6px 0;
  border-radius:14px;
  border:none;
  background:#111827;
  color:white;
}

button{
  background:var(--primary);
  font-weight:bold;
}

.item{
  background:var(--card);
  padding:12px;
  margin:8px 0;
  border-radius:14px;
}

.masuk{border-left:4px solid var(--green);}
.keluar{border-left:4px solid var(--red);}

.tgl{
  font-size:11px;
  color:#9ca3af;
  margin-top:4px;
}

.log{
  background:black;
  padding:8px;
  font-size:11px;
  height:70px;
  overflow:auto;
}
</style>

</head>

<body>

<div class="app">

<h2>Budggt Lite</h2>

<div id="saldo">Rp 0</div>

<input id="nama" placeholder="Keterangan">
<input id="jumlah" placeholder="Nominal">

<select id="tipe">
<option value="masuk">Pemasukan</option>
<option value="keluar">Pengeluaran</option>
</select>

<button id="btnSimpan">SIMPAN</button>

<h3>Riwayat</h3>
<div id="list"></div>

<h4>Debug Log</h4>
<div class="log" id="log"></div>

</div>

<script>
// ===== FORMAT RUPIAH SAAT KETIK =====
function rupiah(angka){
  let num = angka.replace(/[^0-9]/g,"")
  return num.replace(/\B(?=(\d{3})+(?!\d))/g,".")
}

document.getElementById("jumlah")
.addEventListener("input", function(e){
  this.value = rupiah(this.value)
})

// ===== DEBUG =====
function log(t){
  document.getElementById("log").innerHTML += t + "<br>"
}

log("Script terbaca âœ”")

// ===== DATABASE =====
let db = JSON.parse(localStorage.getItem("budggt")) || []
log("DB dimuat: " + db.length)

// ===== FORMAT TANGGAL =====
function formatTgl(t){
  let d = new Date(t)
  return d.toLocaleString("id-ID")
}

// ===== RENDER =====
function render(){

  let list = document.getElementById("list")
  let saldo = 0
  list.innerHTML=""

  db.forEach(x=>{

    saldo += x.tipe=="masuk" ? x.jumlah : -x.jumlah

    list.innerHTML += `
    <div class="item ${x.tipe}">
      <div>${x.nama} â€” Rp ${x.jumlah.toLocaleString()}</div>
      <div class="tgl">ðŸ“… ${formatTgl(x.tgl)}</div>
    </div>`
  })

  document.getElementById("saldo").innerText =
    "Rp " + saldo.toLocaleString()

  localStorage.setItem("budggt",JSON.stringify(db))
}

// ===== TAMBAH =====
function tambah(){

  let nama = document.getElementById("nama").value
  let jml = document.getElementById("jumlah").value

  // ubah dari 10.000 â†’ 10000
  let jumlah = Number(jml.replace(/\./g,""))

  let tipe = document.getElementById("tipe").value

  if(!nama || !jumlah){
    alert("Isi dulu datanya")
    return
  }

  db.unshift({
    nama,
    jumlah,
    tipe,
    tgl:new Date()
  })

  render()

  document.getElementById("nama").value=""
  document.getElementById("jumlah").value=""
}

document.getElementById("btnSimpan")
  .addEventListener("click", tambah)

render()
</script>

</body>
</html>
